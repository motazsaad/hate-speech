{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"Bert Preprocess | OFF | Language model | 22/5/2021 | QARiB ","provenance":[{"file_id":"1CAhrcwHO5QXXNk_NbIEOiCLHF8Af4Ubs","timestamp":1621670656698},{"file_id":"1mwyOGZsoZeODQ1c8n34oiekc9byIcv4N","timestamp":1620116283709},{"file_id":"1P9iQHtUH5KUbTVtp8B4-AopZzEEPE0lw","timestamp":1618868148454}],"collapsed_sections":[],"toc_visible":true},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"ddb80760c3d84f05870ff23ec9250414":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_1d6e1dd89449418ca394402889b733e0","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_28219a6ccbd04595ba174f2b6b063948","IPY_MODEL_54f96e5a8734423094beb8655482e705"]}},"1d6e1dd89449418ca394402889b733e0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"28219a6ccbd04595ba174f2b6b063948":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_3b6d9d96bdab4eed8441c36b41c23402","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":576,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":576,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_cf28eb1b8f8c40a69b9334a37aa57c55"}},"54f96e5a8734423094beb8655482e705":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_340d51ebaa2c4e34afc4a0f9e32d8d45","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 576/576 [00:01&lt;00:00, 362B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_41abeeb452804367a26c7fb427c97529"}},"3b6d9d96bdab4eed8441c36b41c23402":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"cf28eb1b8f8c40a69b9334a37aa57c55":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"340d51ebaa2c4e34afc4a0f9e32d8d45":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"41abeeb452804367a26c7fb427c97529":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5cca4c780aef45b9983beb5b176f5946":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_ead495a460af4ea69efc05f41435b2b9","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_dc9e2b84450742fe9dcf3a5204223b01","IPY_MODEL_6c8d02cc0b2948a280b3bdcfbd137f58"]}},"ead495a460af4ea69efc05f41435b2b9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"dc9e2b84450742fe9dcf3a5204223b01":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_474c7f0bbd604a89bda295f06c22e341","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":717711,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":717711,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_29b043f0d4a9434f8ff26a33e87b40ca"}},"6c8d02cc0b2948a280b3bdcfbd137f58":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_466cecf8b56a437faead1f35d0b2f8b6","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 718k/718k [00:01&lt;00:00, 629kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_53f5a06882b348d5a027599ef9dcb5ba"}},"474c7f0bbd604a89bda295f06c22e341":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"29b043f0d4a9434f8ff26a33e87b40ca":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"466cecf8b56a437faead1f35d0b2f8b6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"53f5a06882b348d5a027599ef9dcb5ba":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ad148f44e3f04b63809850bcdb418f6c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_5d5d17b7f99547a69ddc82842ab43bc2","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_04e0e6c67b4e45759f50a7265783a5c6","IPY_MODEL_68de035902234e77aa9e1196a8231339"]}},"5d5d17b7f99547a69ddc82842ab43bc2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"04e0e6c67b4e45759f50a7265783a5c6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_fc2e93c9cd544ed0aaf1d76ab5e4005c","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":543452854,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":543452854,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5b9d84c8f561444db8ad803a02f7e144"}},"68de035902234e77aa9e1196a8231339":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_b6b4ddaa50d34a958e3f25c2e4661796","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 543M/543M [00:16&lt;00:00, 33.7MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7f67cfd59dd640019845360903a0dc3f"}},"fc2e93c9cd544ed0aaf1d76ab5e4005c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"5b9d84c8f561444db8ad803a02f7e144":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b6b4ddaa50d34a958e3f25c2e4661796":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"7f67cfd59dd640019845360903a0dc3f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"g4mZ8KYblg-g"},"source":["#installing dependencies"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"IbHOBNd4ETRD","executionInfo":{"status":"ok","timestamp":1621924302876,"user_tz":-180,"elapsed":23450,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"48407569-77d8-4f55-ccad-d830f69ee2b0"},"source":["from google.colab import drive\n","drive.mount('/content/drive')\n"],"execution_count":1,"outputs":[{"output_type":"stream","text":["Mounted at /content/drive\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"C4tlwQ8si_FI","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1621924309837,"user_tz":-180,"elapsed":3959,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"3767b645-e937-4f9c-95a2-14a5bfaac2f4"},"source":["import torch\n","\n","# If there's a GPU available...\n","if torch.cuda.is_available():    \n","\n","    # Tell PyTorch to use the GPU.    \n","    device = torch.device(\"cuda\")\n","\n","    print('There are %d GPU(s) available.' % torch.cuda.device_count())\n","\n","    print('We will use the GPU:', torch.cuda.get_device_name(0))\n","    !nvidia-smi\n","\n","# If not...\n","else:\n","    print('No GPU available, using the CPU instead.')\n","    device = torch.device(\"cpu\")"],"execution_count":2,"outputs":[{"output_type":"stream","text":["There are 1 GPU(s) available.\n","We will use the GPU: Tesla T4\n","Tue May 25 06:31:48 2021       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 465.19.01    Driver Version: 460.32.03    CUDA Version: 11.2     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   61C    P8    11W /  70W |      3MiB / 15109MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"y024z5AnlTLz","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1621924335128,"user_tz":-180,"elapsed":25294,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"6e518e25-7177-4564-8523-01098e2157e2"},"source":["!pip install -q optuna==2.3.0\n","!pip install -q transformers==4.2.1\n","!pip install -q farasapy\n","!pip install -q pyarabic\n","!git clone https://huggingface.co/qarib/bert-base-qarib"],"execution_count":3,"outputs":[{"output_type":"stream","text":["\u001b[?25l\r\u001b[K     |█▎                              | 10kB 25.2MB/s eta 0:00:01\r\u001b[K     |██▌                             | 20kB 16.9MB/s eta 0:00:01\r\u001b[K     |███▉                            | 30kB 14.7MB/s eta 0:00:01\r\u001b[K     |█████                           | 40kB 13.6MB/s eta 0:00:01\r\u001b[K     |██████▍                         | 51kB 7.6MB/s eta 0:00:01\r\u001b[K     |███████▋                        | 61kB 8.9MB/s eta 0:00:01\r\u001b[K     |████████▉                       | 71kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████▏                     | 81kB 9.2MB/s eta 0:00:01\r\u001b[K     |███████████▍                    | 92kB 9.0MB/s eta 0:00:01\r\u001b[K     |████████████▊                   | 102kB 7.4MB/s eta 0:00:01\r\u001b[K     |██████████████                  | 112kB 7.4MB/s eta 0:00:01\r\u001b[K     |███████████████▏                | 122kB 7.4MB/s eta 0:00:01\r\u001b[K     |████████████████▌               | 133kB 7.4MB/s eta 0:00:01\r\u001b[K     |█████████████████▊              | 143kB 7.4MB/s eta 0:00:01\r\u001b[K     |███████████████████             | 153kB 7.4MB/s eta 0:00:01\r\u001b[K     |████████████████████▎           | 163kB 7.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████▌          | 174kB 7.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████▉         | 184kB 7.4MB/s eta 0:00:01\r\u001b[K     |████████████████████████        | 194kB 7.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▍      | 204kB 7.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▋     | 215kB 7.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▉    | 225kB 7.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▏  | 235kB 7.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▍ | 245kB 7.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▊| 256kB 7.4MB/s eta 0:00:01\r\u001b[K     |████████████████████████████████| 266kB 7.4MB/s \n","\u001b[?25h  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","    Preparing wheel metadata ... \u001b[?25l\u001b[?25hdone\n","\u001b[K     |████████████████████████████████| 174kB 27.3MB/s \n","\u001b[K     |████████████████████████████████| 81kB 9.3MB/s \n","\u001b[K     |████████████████████████████████| 81kB 11.0MB/s \n","\u001b[K     |████████████████████████████████| 143kB 26.9MB/s \n","\u001b[K     |████████████████████████████████| 112kB 25.8MB/s \n","\u001b[K     |████████████████████████████████| 51kB 8.0MB/s \n","\u001b[?25h  Building wheel for optuna (PEP 517) ... \u001b[?25l\u001b[?25hdone\n","  Building wheel for pyperclip (setup.py) ... \u001b[?25l\u001b[?25hdone\n","\u001b[K     |████████████████████████████████| 1.8MB 6.7MB/s \n","\u001b[K     |████████████████████████████████| 2.9MB 34.6MB/s \n","\u001b[K     |████████████████████████████████| 901kB 38.1MB/s \n","\u001b[K     |████████████████████████████████| 112kB 7.5MB/s \n","\u001b[?25h  Building wheel for pyarabic (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Cloning into 'bert-base-qarib'...\n","remote: Enumerating objects: 62, done.\u001b[K\n","remote: Counting objects: 100% (62/62), done.\u001b[K\n","remote: Compressing objects: 100% (61/61), done.\u001b[K\n","remote: Total 62 (delta 29), reused 0 (delta 0)\u001b[K\n","Unpacking objects: 100% (62/62), done.\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"krBvefg6l6vv","executionInfo":{"status":"ok","timestamp":1621924335628,"user_tz":-180,"elapsed":506,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["!mkdir data\n","!mkdir train"],"execution_count":4,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"TVay9KamnC3I"},"source":["#Creating training datasets"]},{"cell_type":"code","metadata":{"id":"hr84ozGinCFh","executionInfo":{"status":"ok","timestamp":1621924335943,"user_tz":-180,"elapsed":317,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["import pandas as pd\n","import numpy as np\n","import re\n","\n","from tqdm import tqdm_notebook as tqdm\n","from sklearn.model_selection import train_test_split\n","all_datasets= []"],"execution_count":5,"outputs":[]},{"cell_type":"code","metadata":{"id":"8PhWP2JzrEci","executionInfo":{"status":"ok","timestamp":1621924335944,"user_tz":-180,"elapsed":7,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["class Dataset:\n","    def __init__(\n","        self,\n","        name,\n","        train,\n","        valid,\n","        test,\n","        label_list,\n","        # label_list_valid,\n","        # label_list_test\n","    ):\n","        self.name = name\n","        self.train = train\n","        self.valid = valid\n","        self.test = test\n","        self.label_list = label_list\n","        # self.label_list_valid = label_list_valid\n","        # self.label_list_test = label_list_test"],"execution_count":6,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"joWPYWGMqLau"},"source":["##Semeval Dataset "]},{"cell_type":"code","metadata":{"id":"lt_lGy85zuca","executionInfo":{"status":"ok","timestamp":1621924335946,"user_tz":-180,"elapsed":7,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["text_cleaning_re = \"[a-zA-Z]|\\d+|[٠١٢٣٤٥٦٧٨٩]|[.#،<>:@,\\\\-_”“٪ًَ]\"\n","def preprocess(text):\n","  # search = [\"أ\",\"إ\",\"آ\",\"ة\",\"_\",\"-\",\"/\",\".\",\"،\",\" و \",\" يا \",'\"',\"ـ\",\"'\",\"ى\",\"\\\\\",'\\n', '\\t','&quot;','?','؟','!','#']\n","  # replace = [\"ا\",\"ا\",\"ا\",\"ه\",\" \",\" \",\"\",\"\",\"\",\" و\",\" يا\",\"\",\"\",\"\",\"ي\",\"\",' ', ' ',' ',' ? ',' ؟ ',' ! ',' ']\n","  #remove tashkeel\n","  p_tashkeel = re.compile(r'[\\u0617-\\u061A\\u064B-\\u0652]')\n","  text = re.sub(p_tashkeel,\"\", str(text))\n","  # text = text.replace('وو', 'و')\n","  # text = text.replace('يي', 'ي')\n","  # text = text.replace('اا', 'ا')\n","  text = re.sub(text_cleaning_re, ' ', str(text).lower()).strip()\n","  #remove longation\n","  text = re.sub(r'(.)\\1+', r'\\1\\1', str(text)) \n","  text = re.sub(r\"([?!¿])\", r\" \\1 \", str(text))\n","  text = re.sub(\"[إأآا]\", \"ا\", str(text))\n","  text = re.sub(\"ى\", \"ي\", str(text))\n","  # text = re.sub(\"ؤ\", \"ء\", text)\n","  # text = re.sub(\"ئ\", \"ء\", text)\n","  text = re.sub(\"ة\", \"ه\", str(text))\n","  # for i in range(0, len(search)):\n","  #       text = text.replace(search[i], replace[i])\n","  \n","  #trim    \n","  # text = text.strip()\n","\n","  tokens = []\n","  for token in text.split():\n","    # if token not in stop_words:\n","      tokens.append(token)\n","  return \" \".join(tokens)"],"execution_count":7,"outputs":[]},{"cell_type":"code","metadata":{"id":"-6oL3qkXmOgJ","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1621924489307,"user_tz":-180,"elapsed":2303,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"63140c31-2ce3-467d-d2ce-173f6ef24dab"},"source":["#load dataset\n","df_train = pd.read_excel(\"/content/drive/MyDrive/MasterThesis/DataSet-forUsing/semeval2020/train.xlsx\")\n","df_valid = pd.read_excel('/content/drive/MyDrive/MasterThesis/DataSet-forUsing/semeval2020/dev.xlsx')\n","df_test_tweets = pd.read_excel('/content/drive/MyDrive/MasterThesis/DataSet-forUsing/semeval2020/test.xlsx')\n","df_test_labels = pd.read_excel('/content/drive/MyDrive/MasterThesis/DataSet-forUsing/semeval2020/offLabel.xlsx')\n","\n","#Rename Columns\n","df_train = df_train.rename(columns={'off': 'OFF_Labels','hs': 'HS_Labels'})\n","df_valid = df_valid.rename(columns={'off': 'OFF_Labels','hs': 'HS_Labels'})\n","df_test_labels=df_test_labels.rename(columns={'labels':'OFF_Labels'})\n","\n","df_test=pd.concat([df_test_tweets, df_test_labels], axis=1)\n","print(df_train)\n","#drop any row have null values\n","df_train=df_train.dropna(how='any',axis=0)\n","df_valid=df_valid.dropna(how='any',axis=0)\n","\n","# df_train.drop(columns=['norm_prep'])\n","df_train.drop(columns=['HS_Labels'])\n","df_valid.drop(columns=['HS_Labels'])\n","\n","# ----------------------------------------------------------------- #\n","DATA_COLUMN = \"tweets\"\n","LABEL_COLUMN = \"OFF_Labels\"\n","\n","# ----------------------------------------------------------------- #\n","\n","df_train = df_train[['tweets','OFF_Labels']]\n","df_valid = df_valid[['tweets','OFF_Labels']]\n","df_test = df_test[['tweets','OFF_Labels']]\n","df_train.columns = [DATA_COLUMN, LABEL_COLUMN]\n","df_valid.columns = [DATA_COLUMN, LABEL_COLUMN]\n","df_test.columns = [DATA_COLUMN,LABEL_COLUMN]\n","# df_test_labels.columns = [LABEL_COLUMN]\n","print(df_train[LABEL_COLUMN].value_counts())\n","print(df_valid[LABEL_COLUMN].value_counts())\n","print(df_test[LABEL_COLUMN].value_counts())\n","\n","label_list_semeval = ['OFF','NOT_OFF']\n","data_semeval = Dataset(\"Data-semeval\", df_train, df_valid,df_test,label_list_semeval)\n","all_datasets.append(data_semeval)\n","\n","# ----------------------------------------------------------------- #\n"],"execution_count":10,"outputs":[{"output_type":"stream","text":["                                                 tweets OFF_Labels HS_Labels\n","0     الحمدلله يارب فوز مهم يا زمالك.. كل الدعم ليكم...    NOT_OFF    NOT_HS\n","1               فدوه يا بخت فدوه يا زمن واحد منكم يجيبه    NOT_OFF    NOT_HS\n","2     RT @USER: يا رب يا واحد يا أحد بحق يوم الاحد ا...        OFF        HS\n","3     RT @USER: #هوا_الحرية يا وجع قلبي عليكي يا امي...    NOT_OFF    NOT_HS\n","4             يا بكون بحياتك الأهم يا إما ما بدي أكون 🎼    NOT_OFF    NOT_HS\n","...                                                 ...        ...       ...\n","6995  @USER يا حمار ، يا جاهل ، نسبة الباطل ما بتتحس...        OFF    NOT_HS\n","6996  RT @USER: @USER كل زق يا طاقية يا واطي يا حقير...        OFF    NOT_HS\n","6997  @USER<LF>يا كبير يا ممتع يا نجم لابد أن تعي جي...    NOT_OFF    NOT_HS\n","6998        يا رب الاتحاد يفوز يا رب. 😭😭 #الاتحاد_النصر    NOT_OFF    NOT_HS\n","6999  يعز عليا ادخل الشارع وملاقيكش واقف مستنيني في ...    NOT_OFF    NOT_HS\n","\n","[7000 rows x 3 columns]\n","NOT_OFF    5576\n","OFF        1408\n","Name: OFF_Labels, dtype: int64\n","NOT_OFF    821\n","OFF        179\n","Name: OFF_Labels, dtype: int64\n","NOT_OFF    1598\n","OFF         402\n","Name: OFF_Labels, dtype: int64\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"-WYy5ikAs7l3","colab":{"base_uri":"https://localhost:8080/","height":721,"output_embedded_package_id":"1HhZKzj1aQ-guF7sOlCe0L16c3o5_sIz6"},"executionInfo":{"status":"ok","timestamp":1621924496414,"user_tz":-180,"elapsed":2047,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"f8c85642-633b-4ce2-ead8-42d954dea283"},"source":["%load_ext google.colab.data_table\n","df_train"],"execution_count":11,"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}]},{"cell_type":"markdown","metadata":{"id":"Bcwdslw7v0Q8"},"source":["#Trainer"]},{"cell_type":"code","metadata":{"id":"HUn2RB6Bvrxj","executionInfo":{"status":"ok","timestamp":1621924501997,"user_tz":-180,"elapsed":3640,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["from transformers import AutoTokenizer, AutoModelForMaskedLM,BertForSequenceClassification,AutoModel\n","import numpy as np\n","from sklearn.metrics import classification_report, accuracy_score, f1_score, confusion_matrix, precision_score , recall_score\n","from transformers import AutoConfig, AutoModelForSequenceClassification, AutoTokenizer, BertTokenizer\n","from transformers.data.processors import SingleSentenceClassificationProcessor\n","from transformers import Trainer , TrainingArguments\n","from transformers.trainer_utils import EvaluationStrategy\n","from transformers.data.processors.utils import InputFeatures\n","from torch.utils.data import Dataset\n","from torch.utils.data import DataLoader\n","from sklearn.utils import resample\n","import logging\n","import torch\n","import optuna \n","# from arabert.preprocess_arabert import preprocess, never_split_tokens"],"execution_count":12,"outputs":[]},{"cell_type":"code","metadata":{"id":"KfNKr05tv7cA","executionInfo":{"status":"ok","timestamp":1621924502002,"user_tz":-180,"elapsed":21,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["logging.basicConfig(level=logging.WARNING)\n","logger = logging.getLogger(__name__)"],"execution_count":13,"outputs":[]},{"cell_type":"code","metadata":{"id":"R4SGYoB2EDJD","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1621924502003,"user_tz":-180,"elapsed":20,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"c7e93146-ff07-4955-f67e-67d035627702"},"source":["for x in all_datasets:\n","  print(x.name)"],"execution_count":14,"outputs":[{"output_type":"stream","text":["Data-semeval\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"62Lma6tT5zJi"},"source":["You can choose which model, and dataset from here along with the max sentence length"]},{"cell_type":"code","metadata":{"id":"vzeVFoz1wDYf","executionInfo":{"status":"ok","timestamp":1621924502005,"user_tz":-180,"elapsed":19,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["dataset_name = 'Data-semeval'\n","# model_name = 'qarib/bert-base-qarib'\n","# https://huggingface.co/UBC-NLP/MARBERT\n","model_name = 'qarib/bert-base-qarib'\n","task_name = 'classification'\n","# num_labels = 2\n","max_len = 256\n"],"execution_count":15,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tcbD2PCiX4vw","executionInfo":{"status":"ok","timestamp":1621924502006,"user_tz":-180,"elapsed":19,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"8236bd3f-2444-4574-8b0d-9914934d393b"},"source":["for d in all_datasets:\n","  if d.name==dataset_name:\n","    selected_dataset = d\n","    print('Dataset found \\n',dataset_name)\n","    break"],"execution_count":16,"outputs":[{"output_type":"stream","text":["Dataset found \n"," Data-semeval\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"PoyaRIGYCEzh","executionInfo":{"status":"ok","timestamp":1621924504265,"user_tz":-180,"elapsed":873,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["# arabert_prep = ArabertPreprocessor(model_name.split(\"/\")[-1])\n","normal_pre_train = selected_dataset.train[DATA_COLUMN].apply(lambda x:   preprocess(x))\n","normal_pre_valid = selected_dataset.valid[DATA_COLUMN].apply(lambda x:   preprocess(x))\n","normal_pre_test = selected_dataset.test[DATA_COLUMN].apply(lambda x:  preprocess(x))  "],"execution_count":17,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0DEimrdSKGHE","executionInfo":{"status":"ok","timestamp":1621931718874,"user_tz":-180,"elapsed":25155,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"04755ca7-d838-4c14-c211-577dd37e1a4f"},"source":["!git clone https://github.com/aub-mind/arabert\n","from arabert.preprocess import ArabertPreprocessor\n","arabert_prep = ArabertPreprocessor(model_name='bert-base-arabert')\n","arabert_prepv2 = ArabertPreprocessor(model_name='bert-base-arabertv2')\n","\n","arabert_prep_train = selected_dataset.train[DATA_COLUMN].apply(lambda x:   arabert_prep.preprocess(x))\n","arabert_prep_valid = selected_dataset.valid[DATA_COLUMN].apply(lambda x:   arabert_prep.preprocess(x))\n","arabert_prep_test = selected_dataset.test[DATA_COLUMN].apply(lambda x:  arabert_prep.preprocess(x))  \n","\n","# arabert_prep= df_train.assign(arabert_prep=arabert_prep_train)\n"],"execution_count":93,"outputs":[{"output_type":"stream","text":["fatal: destination path 'arabert' already exists and is not an empty directory.\n"],"name":"stdout"},{"output_type":"stream","text":["[2021-05-25 08:34:53,180 - farasapy_logger - WARNING]: Be careful with large lines as they may break on interactive mode. You may switch to Standalone mode for such cases.\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"9-hOmVw4JN4N","executionInfo":{"status":"ok","timestamp":1621931733977,"user_tz":-180,"elapsed":3,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["df_train=df_train.assign(norm_prep=normal_pre_train)\n","# pre_process_col=df_train.to_excel(\"/content/drive/MyDrive/MasterThesis/DataSet-forUsing/semeval2020/train.xlsx\",index=False);\n","df_train= df_train.assign(arabert_prep=arabert_prep_train)\n","# df_train.to_excel(\"/content/drive/MyDrive/MasterThesis/DataSet-forUsing/semeval2020/train.xlsx\",index=False);"],"execution_count":96,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":587},"id":"xPqf_um9Xls_","executionInfo":{"status":"ok","timestamp":1621931734401,"user_tz":-180,"elapsed":7,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"db0f782f-12e0-44f6-d6c1-4690d08e3ce0"},"source":["df_train[:10]"],"execution_count":97,"outputs":[{"output_type":"execute_result","data":{"application/vnd.google.colaboratory.module+javascript":"\n      import \"https://ssl.gstatic.com/colaboratory/data_table/a6224c040fa35dcf/data_table.js\";\n\n      window.createDataTable({\n        data: [[{\n            'v': 0,\n            'f': \"0\",\n        },\n\"\\u0627\\u0644\\u062d\\u0645\\u062f\\u0644\\u0644\\u0647 \\u064a\\u0627\\u0631\\u0628 \\u0641\\u0648\\u0632 \\u0645\\u0647\\u0645 \\u064a\\u0627 \\u0632\\u0645\\u0627\\u0644\\u0643.. \\u0643\\u0644 \\u0627\\u0644\\u062f\\u0639\\u0645 \\u0644\\u064a\\u0643\\u0645 \\u064a\\u0627 \\u0631\\u062c\\u0627\\u0644\\u0629 \\u26aa\\ud83d\\udd34<LF>\\u0627\\u0644\\u062f\\u0648\\u0631\\u064a \\u064a\\u0627 \\u0632\\u0645\\u0627\\u0644\\u0643 .. \\u0627\\u0644\\u062f\\u0648\\u0631\\u064a \\u064a\\u0627 \\u0632\\u0645\\u0627\\u0644\\u0643<LF>#\\u0635\\u062f\\u0627\\u0631\\u0629_\\u0628\\u0633\",\n\"NOT_OFF\",\n\"\\u0627\\u0644\\u062d\\u0645\\u062f\\u0644\\u0644\\u0647 \\u064a\\u0627\\u0631\\u0628 \\u0641\\u0648\\u0632 \\u0645\\u0647\\u0645 \\u064a\\u0627 \\u0632\\u0645\\u0627\\u0644\\u0643 \\u0643\\u0644 \\u0627\\u0644\\u062f\\u0639\\u0645 \\u0644\\u064a\\u0643\\u0645 \\u064a\\u0627 \\u0631\\u062c\\u0627\\u0644\\u0647 \\u26aa\\ud83d\\udd34 \\u0627\\u0644\\u062f\\u0648\\u0631\\u064a \\u064a\\u0627 \\u0632\\u0645\\u0627\\u0644\\u0643 \\u0627\\u0644\\u062f\\u0648\\u0631\\u064a \\u064a\\u0627 \\u0632\\u0645\\u0627\\u0644\\u0643 \\u0635\\u062f\\u0627\\u0631\\u0647 \\u0628\\u0633\",\n\"\\u0627\\u0644+ \\u062d\\u0645\\u062f\\u0644\\u0644\\u0647 \\u064a\\u0627\\u0631\\u0628 \\u0641\\u0648\\u0632 \\u0645\\u0647\\u0645 \\u064a\\u0627 \\u0632\\u0645\\u0627\\u0644\\u0643 . \\u0643\\u0644 \\u0627\\u0644+ \\u062f\\u0639\\u0645 \\u0644\\u064a +\\u0643\\u0645 \\u064a\\u0627 \\u0631\\u062c\\u0627\\u0644 +\\u0629 \\u26aa ? ? < LF > \\u0627\\u0644+ \\u062f\\u0648\\u0631\\u064a \\u064a\\u0627 \\u0632\\u0645\\u0627\\u0644\\u0643 . \\u0627\\u0644+ \\u062f\\u0648\\u0631\\u064a \\u064a\\u0627 \\u0632\\u0645\\u0627\\u0644\\u0643 < LF > # \\u0635\\u062f\\u0627\\u0631 +\\u0629 _ \\u0628\\u0633\",\n{\n            'v': 20,\n            'f': \"20\",\n        }],\n [{\n            'v': 1,\n            'f': \"1\",\n        },\n\"\\u0641\\u062f\\u0648\\u0647 \\u064a\\u0627 \\u0628\\u062e\\u062a \\u0641\\u062f\\u0648\\u0647 \\u064a\\u0627 \\u0632\\u0645\\u0646 \\u0648\\u0627\\u062d\\u062f \\u0645\\u0646\\u0643\\u0645 \\u064a\\u062c\\u064a\\u0628\\u0647\",\n\"NOT_OFF\",\n\"\\u0641\\u062f\\u0648\\u0647 \\u064a\\u0627 \\u0628\\u062e\\u062a \\u0641\\u062f\\u0648\\u0647 \\u064a\\u0627 \\u0632\\u0645\\u0646 \\u0648\\u0627\\u062d\\u062f \\u0645\\u0646\\u0643\\u0645 \\u064a\\u062c\\u064a\\u0628\\u0647\",\n\"\\u0641+ \\u062f\\u0648 +\\u0647 \\u064a\\u0627 \\u0628\\u062e\\u062a \\u0641+ \\u062f\\u0648 +\\u0647 \\u064a\\u0627 \\u0632\\u0645\\u0646 \\u0648\\u0627\\u062d\\u062f \\u0645\\u0646 +\\u0643\\u0645 \\u064a\\u062c\\u064a\\u0628 +\\u0647\",\n{\n            'v': 9,\n            'f': \"9\",\n        }],\n [{\n            'v': 2,\n            'f': \"2\",\n        },\n\"RT @USER: \\u064a\\u0627 \\u0631\\u0628 \\u064a\\u0627 \\u0648\\u0627\\u062d\\u062f \\u064a\\u0627 \\u0623\\u062d\\u062f \\u0628\\u062d\\u0642 \\u064a\\u0648\\u0645 \\u0627\\u0644\\u0627\\u062d\\u062f \\u0627\\u0646 \\u062a\\u0647\\u0644\\u0643 \\u0628\\u0646\\u064a \\u0633\\u0639\\u0648\\u062f \\u0627\\u0644\\u0645\\u062c\\u0631\\u0645\\u064a\\u0646. \\u0644\\u0627\\u062c\\u0644 \\u0627\\u0637\\u0641\\u0627\\u0644 \\u0627\\u0644\\u064a\\u0645\\u0646 \\u0634\\u0627\\u0631\\u0643\\u0648\\u0627.\",\n\"OFF\",\n\"\\u064a\\u0627 \\u0631\\u0628 \\u064a\\u0627 \\u0648\\u0627\\u062d\\u062f \\u064a\\u0627 \\u0627\\u062d\\u062f \\u0628\\u062d\\u0642 \\u064a\\u0648\\u0645 \\u0627\\u0644\\u0627\\u062d\\u062f \\u0627\\u0646 \\u062a\\u0647\\u0644\\u0643 \\u0628\\u0646\\u064a \\u0633\\u0639\\u0648\\u062f \\u0627\\u0644\\u0645\\u062c\\u0631\\u0645\\u064a\\u0646 \\u0644\\u0627\\u062c\\u0644 \\u0627\\u0637\\u0641\\u0627\\u0644 \\u0627\\u0644\\u064a\\u0645\\u0646 \\u0634\\u0627\\u0631\\u0643\\u0648\\u0627\",\n\"RT [\\u0645\\u0633\\u062a\\u062e\\u062f\\u0645] : \\u064a\\u0627 \\u0631\\u0628 \\u064a\\u0627 \\u0648\\u0627\\u062d\\u062f \\u064a\\u0627 \\u0623\\u062d\\u062f \\u0628+ \\u062d\\u0642 \\u064a\\u0648\\u0645 \\u0627\\u0644+ \\u0627\\u062d\\u062f +\\u0627\\u0646 \\u062a\\u0647\\u0644\\u0643 \\u0628\\u0646\\u064a \\u0633\\u0639\\u0648\\u062f \\u0627\\u0644+ \\u0645\\u062c\\u0631\\u0645 +\\u064a\\u0646 . \\u0644+ \\u0623\\u062c\\u0644 \\u0623\\u0637\\u0641\\u0627\\u0644 \\u0627\\u0644+ \\u064a\\u0645\\u0646 \\u0634\\u0627\\u0631\\u0643 +\\u0648\\u0627 .\",\n{\n            'v': 18,\n            'f': \"18\",\n        }],\n [{\n            'v': 3,\n            'f': \"3\",\n        },\n\"RT @USER: #\\u0647\\u0648\\u0627_\\u0627\\u0644\\u062d\\u0631\\u064a\\u0629 \\u064a\\u0627 \\u0648\\u062c\\u0639 \\u0642\\u0644\\u0628\\u064a \\u0639\\u0644\\u064a\\u0643\\u064a \\u064a\\u0627 \\u0627\\u0645\\u064a...<LF>\\u0627\\u0644\\u0644\\u0647 \\u0644\\u0627 \\u064a\\u062d\\u0631\\u0642 \\u0642\\u0644\\u0628\\u0643 \\u0648\\u064a\\u0643\\u0633\\u0631 \\u0628\\u062e\\u0627\\u0637\\u0631\\u0643 \\u0644\\u0644\\u0645\\u0631\\u0629 \\u0627\\u0644\\u0641 \\u0646\\u0642\\u0641 \\u0625\\u062c\\u0644\\u0627\\u0644 \\u0644\\u0639\\u0638\\u0645\\u0629 \\u0648\\u0642\\u062f\\u0631\\u0629 \\u0644\\u064a\\u0646 \\u0642\\u0644\\u0628 \\u0627\\u0644\\u0623\\u0645 \\u0627\\u0644\\u2026\",\n\"NOT_OFF\",\n\"\\u0647\\u0648\\u0627 \\u0627\\u0644\\u062d\\u0631\\u064a\\u0647 \\u064a\\u0627 \\u0648\\u062c\\u0639 \\u0642\\u0644\\u0628\\u064a \\u0639\\u0644\\u064a\\u0643\\u064a \\u064a\\u0627 \\u0627\\u0645\\u064a \\u0627\\u0644\\u0644\\u0647 \\u0644\\u0627 \\u064a\\u062d\\u0631\\u0642 \\u0642\\u0644\\u0628\\u0643 \\u0648\\u064a\\u0643\\u0633\\u0631 \\u0628\\u062e\\u0627\\u0637\\u0631\\u0643 \\u0644\\u0644\\u0645\\u0631\\u0647 \\u0627\\u0644\\u0641 \\u0646\\u0642\\u0641 \\u0627\\u062c\\u0644\\u0627\\u0644 \\u0644\\u0639\\u0638\\u0645\\u0647 \\u0648\\u0642\\u062f\\u0631\\u0647 \\u0644\\u064a\\u0646 \\u0642\\u0644\\u0628 \\u0627\\u0644\\u0627\\u0645 \\u0627\\u0644\\u2026\",\n\"RT [\\u0645\\u0633\\u062a\\u062e\\u062f\\u0645] : # \\u0647\\u0648 +\\u0627 _ \\u0627\\u0644+ \\u062d\\u0631\\u064a +\\u0629 \\u064a\\u0627 \\u0648\\u062c\\u0639 \\u0642\\u0644\\u0628 +\\u064a \\u0639\\u0644\\u064a\\u0643\\u064a \\u064a\\u0627 \\u0623\\u0645 +\\u064a . < LF > \\u0627\\u0644\\u0644\\u0647 \\u0644\\u0627 \\u064a\\u062d\\u0631\\u0642 \\u0642\\u0644\\u0628 \\u0643+ \\u0648+ \\u064a\\u0643\\u0633\\u0631 \\u0628+ \\u062e\\u0627\\u0637\\u0631 \\u0643+ \\u0644+ \\u0627\\u0644+ \\u0645\\u0631 +\\u0629 \\u0623\\u0644\\u0641 \\u0646\\u0642\\u0641 \\u0625\\u062c\\u0644\\u0627\\u0644 \\u0644+ \\u0639\\u0638\\u0645 +\\u0629 \\u0648+ \\u0642\\u062f\\u0631 +\\u0629 \\u0644\\u064a\\u0646 \\u0642\\u0644\\u0628 \\u0627\\u0644+ \\u0623\\u0645 \\u0627\\u0644+ \\\\ .\",\n{\n            'v': 24,\n            'f': \"24\",\n        }],\n [{\n            'v': 4,\n            'f': \"4\",\n        },\n\"\\u064a\\u0627 \\u0628\\u0643\\u0648\\u0646 \\u0628\\u062d\\u064a\\u0627\\u062a\\u0643 \\u0627\\u0644\\u0623\\u0647\\u0645 \\u064a\\u0627 \\u0625\\u0645\\u0627 \\u0645\\u0627 \\u0628\\u062f\\u064a \\u0623\\u0643\\u0648\\u0646 \\ud83c\\udfbc\",\n\"NOT_OFF\",\n\"\\u064a\\u0627 \\u0628\\u0643\\u0648\\u0646 \\u0628\\u062d\\u064a\\u0627\\u062a\\u0643 \\u0627\\u0644\\u0627\\u0647\\u0645 \\u064a\\u0627 \\u0627\\u0645\\u0627 \\u0645\\u0627 \\u0628\\u062f\\u064a \\u0627\\u0643\\u0648\\u0646 \\ud83c\\udfbc\",\n\"\\u064a\\u0627 \\u0628+ \\u0643\\u0648\\u0646 \\u0628+ \\u062d\\u064a\\u0627 +\\u062a \\u0643+ \\u0627\\u0644+ \\u0623\\u0647\\u0645 \\u064a\\u0627 \\u0625\\u0645\\u0627 \\u0645\\u0627 \\u0628\\u062f\\u064a \\u0623\\u0643\\u0648\\u0646 ? ?\",\n{\n            'v': 10,\n            'f': \"10\",\n        }],\n [{\n            'v': 5,\n            'f': \"5\",\n        },\n\"@USER \\u0627\\u062e\\u062e \\u064a\\u0627 \\u0642\\u0644\\u0628\\u0628\\u064a \\u064a\\u0627 \\u0647\\u0627\\u0644\\u062d\\u0644\\u0642\\u0647 \\ud83d\\ude29\\ud83d\\ude2d\\u2665\\ufe0f \\u0645\\u062a\\u0639\\u0647 \\u0639\\u0644\\u0649 \\u0628\\u0643\\u0627\\u0621 \\u0639\\u0644\\u0649 \\u062d\\u0645\\u0627\\u0633 \\u0643\\u0644 \\u0627\\u0644\\u0645\\u0634\\u0627\\u0639\\u0631 \\u062f\\u0627\\u062e\\u0644\\u0647 \\u0628\\u0628\\u0639\\u0636\",\n\"NOT_OFF\",\n\"\\u0627\\u062e\\u062e \\u064a\\u0627 \\u0642\\u0644\\u0628\\u0628\\u064a \\u064a\\u0627 \\u0647\\u0627\\u0644\\u062d\\u0644\\u0642\\u0647 \\ud83d\\ude29\\ud83d\\ude2d\\u2665\\ufe0f \\u0645\\u062a\\u0639\\u0647 \\u0639\\u0644\\u064a \\u0628\\u0643\\u0627\\u0621 \\u0639\\u0644\\u064a \\u062d\\u0645\\u0627\\u0633 \\u0643\\u0644 \\u0627\\u0644\\u0645\\u0634\\u0627\\u0639\\u0631 \\u062f\\u0627\\u062e\\u0644\\u0647 \\u0628\\u0628\\u0639\\u0636\",\n\"[\\u0645\\u0633\\u062a\\u062e\\u062f\\u0645] \\u0627\\u062e\\u062e \\u064a\\u0627 \\u0642\\u0644\\u0628\\u0628\\u064a \\u064a\\u0627 \\u0647\\u0627\\u0644\\u062d\\u0644\\u0642\\u0647 ? ? ? ? \\u2665 \\ufe0f \\u0645\\u062a\\u0639 +\\u0647 \\u0639\\u0644\\u0649 \\u0628\\u0643\\u0627\\u0621 \\u0639\\u0644\\u0649 \\u062d\\u0645\\u0627\\u0633 \\u0643\\u0644 \\u0627\\u0644+ \\u0645\\u0634\\u0627\\u0639\\u0631 \\u062f\\u0627\\u062e\\u0644 +\\u0647 \\u0628+ \\u0628\\u0639\\u0636\",\n{\n            'v': 15,\n            'f': \"15\",\n        }],\n [{\n            'v': 6,\n            'f': \"6\",\n        },\n\"\\u0648\\u0627\\u0644\\u0644\\u0647 \\u0627\\u0644\\u0632\\u0648\\u0644 \\u0627\\u0644\\u0633\\u0648\\u062f\\u0627\\u0646\\u064a \\u0623\\u062b\\u0628\\u062a \\u0623\\u0646\\u0647 \\u0633\\u0627\\u0628\\u0642 \\u0628\\u0627\\u0644\\u062a\\u062d\\u0636\\u0651\\u0631 \\u0639\\u0646 \\u0643\\u0644 \\u0627\\u0644\\u0639\\u0631\\u0628:<LF>\\u0664\\u0660\\u066a \\u0627\\u0644\\u062a\\u0645\\u062b\\u064a\\u0644 \\u0627\\u0644\\u0646\\u0633\\u0627\\u0626\\u064a \\u0641\\u064a \\u0627\\u0644\\u0645\\u062c\\u0644\\u0633 \\u0627\\u0644\\u062a\\u0634\\u0631\\u064a\\u0639\\u064a \\u0627\\u0644\\u0633\\u0648\\u062f\\u0627\\u0646\\u064a \\u0645\\u0627 \\u0628\\u0639\\u062f \\u0627\\u0644\\u062b\\u0648\\u0631\\u0629. <LF>\\u0627\\u0644\\u0643\\u0644\\u0627\\u0645 \\u0625\\u0644\\u0643 \\u064a\\u0627 \\u062c\\u0627\\u0631\\u0629 \\u0644\\u062a\\u0633\\u0645\\u0639\\u064a \\u064a\\u0627 \\u0643\\u0646\\u0651\\u0629!<LF>#\\u0627\\u0644\\u0633\\u0648\\u062f\\u0627\\u0646 #\\u0633\\u0648\\u0631\\u064a\\u0627 #\\u0627\\u0644\\u062c\\u0632\\u0627\\u0626\\u0631\",\n\"NOT_OFF\",\n\"\\u0648\\u0627\\u0644\\u0644\\u0647 \\u0627\\u0644\\u0632\\u0648\\u0644 \\u0627\\u0644\\u0633\\u0648\\u062f\\u0627\\u0646\\u064a \\u0627\\u062b\\u0628\\u062a \\u0627\\u0646\\u0647 \\u0633\\u0627\\u0628\\u0642 \\u0628\\u0627\\u0644\\u062a\\u062d\\u0636\\u0631 \\u0639\\u0646 \\u0643\\u0644 \\u0627\\u0644\\u0639\\u0631\\u0628 \\u0627\\u0644\\u062a\\u0645\\u062b\\u064a\\u0644 \\u0627\\u0644\\u0646\\u0633\\u0627\\u0626\\u064a \\u0641\\u064a \\u0627\\u0644\\u0645\\u062c\\u0644\\u0633 \\u0627\\u0644\\u062a\\u0634\\u0631\\u064a\\u0639\\u064a \\u0627\\u0644\\u0633\\u0648\\u062f\\u0627\\u0646\\u064a \\u0645\\u0627 \\u0628\\u0639\\u062f \\u0627\\u0644\\u062b\\u0648\\u0631\\u0647 \\u0627\\u0644\\u0643\\u0644\\u0627\\u0645 \\u0627\\u0644\\u0643 \\u064a\\u0627 \\u062c\\u0627\\u0631\\u0647 \\u0644\\u062a\\u0633\\u0645\\u0639\\u064a \\u064a\\u0627 \\u0643\\u0646\\u0647 ! \\u0627\\u0644\\u0633\\u0648\\u062f\\u0627\\u0646 \\u0633\\u0648\\u0631\\u064a\\u0627 \\u0627\\u0644\\u062c\\u0632\\u0627\\u0626\\u0631\",\n\"\\u0648+ \\u0627\\u0644\\u0644\\u0647 \\u0627\\u0644+ \\u0632\\u0648\\u0644 \\u0627\\u0644+ \\u0633\\u0648\\u062f\\u0627\\u0646\\u064a \\u0623\\u062b\\u0628\\u062a \\u0623\\u0646 +\\u0647 \\u0633\\u0627\\u0628\\u0642 \\u0628+ \\u0627\\u0644+ \\u062a\\u062d\\u0636\\u0631 \\u0639\\u0646 \\u0643\\u0644 \\u0627\\u0644+ \\u0639\\u0631\\u0628 : < LF > 40 \\u066a \\u0627\\u0644+ \\u062a\\u0645\\u062b\\u064a\\u0644 \\u0627\\u0644+ \\u0646\\u0633\\u0627\\u0626\\u064a \\u0641\\u064a \\u0627\\u0644+ \\u0645\\u062c\\u0644\\u0633 \\u0627\\u0644+ \\u062a\\u0634\\u0631\\u064a\\u0639\\u064a \\u0627\\u0644+ \\u0633\\u0648\\u062f\\u0627\\u0646\\u064a \\u0645\\u0627 \\u0628\\u0639\\u062f \\u0627\\u0644+ \\u062b\\u0648\\u0631 +\\u0629 . < LF > \\u0627\\u0644+ \\u0643\\u0644\\u0627\\u0645 \\u0625\\u0644\\u0643 \\u064a\\u0627 \\u062c\\u0627\\u0631 +\\u0629 \\u0644+ \\u062a\\u0633\\u0645\\u0639 +\\u064a \\u064a\\u0627 +\\u0643\\u0646 +\\u0629 ! < LF > # \\u0627\\u0644+ \\u0633\\u0648\\u062f\\u0627\\u0646 # \\u0633\\u0648\\u0631\\u064a\\u0627 # \\u0627\\u0644+ \\u062c\\u0632\\u0627\\u0626\\u0631\",\n{\n            'v': 30,\n            'f': \"30\",\n        }],\n [{\n            'v': 7,\n            'f': \"7\",\n        },\n\"RT @USER: \\u062c\\u0627\\u0644\\u0633 \\u0623\\u0633\\u0645\\u0639 \\u0623\\u062d\\u0645\\u062f \\u0642\\u0627\\u0633\\u0645 \\u064a\\u063a\\u0646\\u064a: \\\"\\u0623\\u062d\\u0628\\u0643 \\u0645\\u0646 \\u0643\\u0644 \\u0642\\u0644\\u0628\\u064a \\u064a\\u0627 \\u0628\\u0644\\u0627\\u062f\\u064a \\u064a\\u0627 \\u064a\\u0645\\u0646\\\". \\u062d\\u062a\\u0649 \\u0623\\u0646\\u0627 \\u0648\\u0627\\u0644\\u0644\\u0647 \\u0623\\u062d\\u0628 \\u0627\\u0644\\u064a\\u0645\\u0646 \\u0645\\u0646 \\u0643\\u0644 \\u0642\\u0644\\u0628\\u064a \\u0623\\u062d\\u0628 \\u0628\\u0644\\u0627\\u062f\\u064a \\u0645\\u0646 \\u0637\\u0631\\u0641\\u0647\\u0627 \\u0644\\u0637\\u0631\\u0641\\u0647\\u0627 \\\"\\u0628\\u2026\",\n\"NOT_OFF\",\n\"\\u062c\\u0627\\u0644\\u0633 \\u0627\\u0633\\u0645\\u0639 \\u0627\\u062d\\u0645\\u062f \\u0642\\u0627\\u0633\\u0645 \\u064a\\u063a\\u0646\\u064a \\\"\\u0627\\u062d\\u0628\\u0643 \\u0645\\u0646 \\u0643\\u0644 \\u0642\\u0644\\u0628\\u064a \\u064a\\u0627 \\u0628\\u0644\\u0627\\u062f\\u064a \\u064a\\u0627 \\u064a\\u0645\\u0646\\\" \\u062d\\u062a\\u064a \\u0627\\u0646\\u0627 \\u0648\\u0627\\u0644\\u0644\\u0647 \\u0627\\u062d\\u0628 \\u0627\\u0644\\u064a\\u0645\\u0646 \\u0645\\u0646 \\u0643\\u0644 \\u0642\\u0644\\u0628\\u064a \\u0627\\u062d\\u0628 \\u0628\\u0644\\u0627\\u062f\\u064a \\u0645\\u0646 \\u0637\\u0631\\u0641\\u0647\\u0627 \\u0644\\u0637\\u0631\\u0641\\u0647\\u0627 \\\"\\u0628\\u2026\",\n\"RT [\\u0645\\u0633\\u062a\\u062e\\u062f\\u0645] : \\u062c\\u0627\\u0644\\u0633 \\u0623\\u0633\\u0645\\u0639 \\u0623\\u062d\\u0645\\u062f \\u0642\\u0627\\u0633\\u0645 \\u064a\\u063a\\u0646\\u064a : \\\" \\u0623\\u062d\\u0628 \\u0643+ \\u0645\\u0646 \\u0643\\u0644 \\u0642\\u0644\\u0628 +\\u064a \\u064a\\u0627 \\u0628\\u0644\\u0627\\u062f +\\u064a \\u064a\\u0627 \\u064a\\u0645\\u0646 \\\" . \\u062d\\u062a\\u0649 \\u0623\\u0646\\u0627 \\u0648+ \\u0627\\u0644\\u0644\\u0647 \\u0623\\u062d\\u0628 \\u0627\\u0644+ \\u064a\\u0645\\u0646 \\u0645\\u0646 \\u0643\\u0644 \\u0642\\u0644\\u0628 +\\u064a \\u0623\\u062d\\u0628 \\u0628\\u0644\\u0627\\u062f +\\u064a \\u0645\\u0646 \\u0637\\u0631\\u0641 +\\u0647\\u0627 \\u0644+ \\u0637\\u0631\\u0641 +\\u0647\\u0627 \\\" \\u0628+ \\\\ .\",\n{\n            'v': 27,\n            'f': \"27\",\n        }],\n [{\n            'v': 8,\n            'f': \"8\",\n        },\n\"\\u0641\\u064a \\u0642\\u0644\\u0628\\u064a \\u064a\\u0627 \\u0645\\u063a\\u0644\\u0627\\u0643<LF>\\u0648\\u0628\\u0639\\u064a\\u0646\\u064a \\u064a\\u0627 \\u0645\\u062d\\u0644\\u0627\\u0643 ..\",\n\"NOT_OFF\",\n\"\\u0641\\u064a \\u0642\\u0644\\u0628\\u064a \\u064a\\u0627 \\u0645\\u063a\\u0644\\u0627\\u0643 \\u0648\\u0628\\u0639\\u064a\\u0646\\u064a \\u064a\\u0627 \\u0645\\u062d\\u0644\\u0627\\u0643\",\n\"\\u0641\\u064a \\u0642\\u0644\\u0628 +\\u064a \\u064a\\u0627 \\u0645\\u063a\\u0644\\u0627 \\u0643+ < LF > \\u0648+ \\u0628+ \\u0639\\u064a\\u0646\\u064a \\u064a\\u0627 \\u0645\\u062d\\u0644\\u0627 \\u0643+ .\",\n{\n            'v': 7,\n            'f': \"7\",\n        }],\n [{\n            'v': 9,\n            'f': \"9\",\n        },\n\"\\u064a\\u0627 \\u0627\\u0644\\u062a\\u0627\\u062c \\u0639 \\u0627\\u0644\\u0631\\u0627\\u0633 \\u064a\\u0627 \\u0627\\u0644\\u0633\\u0627\\u062f\\u0629<LF>\\u064a\\u0627 \\u0645\\u0627\\u0644\\u0643 \\u0627\\u0644\\u0631\\u0648\\u062d \\u0648\\u0631\\u0627\\u0639\\u064a\\u0647\\u0627\\u2764\\ufe0f\",\n\"NOT_OFF\",\n\"\\u064a\\u0627 \\u0627\\u0644\\u062a\\u0627\\u062c \\u0639 \\u0627\\u0644\\u0631\\u0627\\u0633 \\u064a\\u0627 \\u0627\\u0644\\u0633\\u0627\\u062f\\u0647 \\u064a\\u0627 \\u0645\\u0627\\u0644\\u0643 \\u0627\\u0644\\u0631\\u0648\\u062d \\u0648\\u0631\\u0627\\u0639\\u064a\\u0647\\u0627\\u2764\\ufe0f\",\n\"\\u064a\\u0627 \\u0627\\u0644+ \\u062a\\u0627\\u062c \\u0639 \\u0627\\u0644+ \\u0631\\u0623\\u0633 \\u064a\\u0627 \\u0627\\u0644+ \\u0633\\u0627\\u062f +\\u0629 < LF > \\u064a\\u0627 \\u0645\\u0627\\u0644\\u0643 \\u0627\\u0644+ \\u0631\\u0648\\u062d \\u0648+ \\u0631\\u0627\\u0639\\u064a +\\u0647\\u0627 \\u2764 \\ufe0f\",\n{\n            'v': 10,\n            'f': \"10\",\n        }]],\n        columns: [[\"number\", \"index\"], [\"string\", \"tweets\"], [\"string\", \"OFF_Labels\"], [\"string\", \"norm_prep\"], [\"string\", \"arabert_prep\"], [\"number\", \"words\"]],\n        columnOptions: [{\"width\": \"1px\", \"className\": \"index_column\"}],\n        rowsPerPage: 25,\n        helpUrl: \"https://colab.research.google.com/notebooks/data_table.ipynb\",\n        suppressOutputScrolling: true,\n        minimumWidth: undefined,\n      });\n    ","text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>tweets</th>\n","      <th>OFF_Labels</th>\n","      <th>norm_prep</th>\n","      <th>arabert_prep</th>\n","      <th>words</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>الحمدلله يارب فوز مهم يا زمالك.. كل الدعم ليكم...</td>\n","      <td>NOT_OFF</td>\n","      <td>الحمدلله يارب فوز مهم يا زمالك كل الدعم ليكم ي...</td>\n","      <td>ال+ حمدلله يارب فوز مهم يا زمالك . كل ال+ دعم ...</td>\n","      <td>20</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>فدوه يا بخت فدوه يا زمن واحد منكم يجيبه</td>\n","      <td>NOT_OFF</td>\n","      <td>فدوه يا بخت فدوه يا زمن واحد منكم يجيبه</td>\n","      <td>ف+ دو +ه يا بخت ف+ دو +ه يا زمن واحد من +كم يج...</td>\n","      <td>9</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>RT @USER: يا رب يا واحد يا أحد بحق يوم الاحد ا...</td>\n","      <td>OFF</td>\n","      <td>يا رب يا واحد يا احد بحق يوم الاحد ان تهلك بني...</td>\n","      <td>RT [مستخدم] : يا رب يا واحد يا أحد ب+ حق يوم ا...</td>\n","      <td>18</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>RT @USER: #هوا_الحرية يا وجع قلبي عليكي يا امي...</td>\n","      <td>NOT_OFF</td>\n","      <td>هوا الحريه يا وجع قلبي عليكي يا امي الله لا يح...</td>\n","      <td>RT [مستخدم] : # هو +ا _ ال+ حري +ة يا وجع قلب ...</td>\n","      <td>24</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>يا بكون بحياتك الأهم يا إما ما بدي أكون 🎼</td>\n","      <td>NOT_OFF</td>\n","      <td>يا بكون بحياتك الاهم يا اما ما بدي اكون 🎼</td>\n","      <td>يا ب+ كون ب+ حيا +ت ك+ ال+ أهم يا إما ما بدي أ...</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>@USER اخخ يا قلببي يا هالحلقه 😩😭♥️ متعه على بك...</td>\n","      <td>NOT_OFF</td>\n","      <td>اخخ يا قلببي يا هالحلقه 😩😭♥️ متعه علي بكاء علي...</td>\n","      <td>[مستخدم] اخخ يا قلببي يا هالحلقه ? ? ? ? ♥ ️ م...</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>والله الزول السوداني أثبت أنه سابق بالتحضّر عن...</td>\n","      <td>NOT_OFF</td>\n","      <td>والله الزول السوداني اثبت انه سابق بالتحضر عن ...</td>\n","      <td>و+ الله ال+ زول ال+ سوداني أثبت أن +ه سابق ب+ ...</td>\n","      <td>30</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>RT @USER: جالس أسمع أحمد قاسم يغني: \"أحبك من ك...</td>\n","      <td>NOT_OFF</td>\n","      <td>جالس اسمع احمد قاسم يغني \"احبك من كل قلبي يا ب...</td>\n","      <td>RT [مستخدم] : جالس أسمع أحمد قاسم يغني : \" أحب...</td>\n","      <td>27</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>في قلبي يا مغلاك&lt;LF&gt;وبعيني يا محلاك ..</td>\n","      <td>NOT_OFF</td>\n","      <td>في قلبي يا مغلاك وبعيني يا محلاك</td>\n","      <td>في قلب +ي يا مغلا ك+ &lt; LF &gt; و+ ب+ عيني يا محلا...</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>يا التاج ع الراس يا السادة&lt;LF&gt;يا مالك الروح ور...</td>\n","      <td>NOT_OFF</td>\n","      <td>يا التاج ع الراس يا الساده يا مالك الروح وراعي...</td>\n","      <td>يا ال+ تاج ع ال+ رأس يا ال+ ساد +ة &lt; LF &gt; يا م...</td>\n","      <td>10</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                              tweets  ... words\n","0  الحمدلله يارب فوز مهم يا زمالك.. كل الدعم ليكم...  ...    20\n","1            فدوه يا بخت فدوه يا زمن واحد منكم يجيبه  ...     9\n","2  RT @USER: يا رب يا واحد يا أحد بحق يوم الاحد ا...  ...    18\n","3  RT @USER: #هوا_الحرية يا وجع قلبي عليكي يا امي...  ...    24\n","4          يا بكون بحياتك الأهم يا إما ما بدي أكون 🎼  ...    10\n","5  @USER اخخ يا قلببي يا هالحلقه 😩😭♥️ متعه على بك...  ...    15\n","6  والله الزول السوداني أثبت أنه سابق بالتحضّر عن...  ...    30\n","7  RT @USER: جالس أسمع أحمد قاسم يغني: \"أحبك من ك...  ...    27\n","8             في قلبي يا مغلاك<LF>وبعيني يا محلاك ..  ...     7\n","9  يا التاج ع الراس يا السادة<LF>يا مالك الروح ور...  ...    10\n","\n","[10 rows x 5 columns]"]},"metadata":{"tags":[]},"execution_count":97}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pHxEvhVtje1A","executionInfo":{"status":"ok","timestamp":1621931748990,"user_tz":-180,"elapsed":274,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"a4838485-098e-479c-dbb9-347802d0a2fc"},"source":["a_list=[]\n","for value in df_train.norm_prep.str.split(' '):\n","    a_list.extend(value)\n","print('Number of words using preprocessing : ', len(a_list))\n","print('Number of uniqe words using preprocessing : ', len(list(set(a_list))))"],"execution_count":98,"outputs":[{"output_type":"stream","text":["Number of words using preprocessing :  129508\n","Number of uniqe words using preprocessing :  32341\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"z7WDwfmSk1S-","executionInfo":{"status":"ok","timestamp":1621931753223,"user_tz":-180,"elapsed":274,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"4b5b67a5-f47b-4cb7-ba48-59e08f619e0d"},"source":["arabert_prep_list=[]\n","for value in df_train.arabert_prep.str.split(' '):\n","    arabert_prep_list.extend(value)\n","print('Number of words using Bert preprocessing : ', len(arabert_prep_list))\n","print('Number of uniqe words using Bert preprocessing : ', len(list(set(arabert_prep_list))))"],"execution_count":99,"outputs":[{"output_type":"stream","text":["Number of words using Bert preprocessing :  233599\n","Number of uniqe words using Bert preprocessing :  18775\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"WE_MmGDceJxj","executionInfo":{"status":"aborted","timestamp":1621929269341,"user_tz":-180,"elapsed":47,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["# selected_dataset.train[DATA_COLUMN]"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wxlgveBVzlTj","executionInfo":{"status":"ok","timestamp":1621932133629,"user_tz":-180,"elapsed":377,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"a513aeb3-a857-4ba1-ba2c-59e7e8a72733"},"source":["for n in range(10):\n","  # info = [[df_train.tweets[n], arabert_prep_train[n]]]\n","  # print( tabulate(info))\n","  print(\"Original: \",df_train.tweets[n])\n","  print(\"normal_pre: \", df_train.norm_prep[n])\n","  print(\"arabert_prep \", df_train.arabert_prep[n])\n","  print('------')"],"execution_count":100,"outputs":[{"output_type":"stream","text":["Original:  الحمدلله يارب فوز مهم يا زمالك.. كل الدعم ليكم يا رجالة ⚪🔴<LF>الدوري يا زمالك .. الدوري يا زمالك<LF>#صدارة_بس\n","normal_pre:  الحمدلله يارب فوز مهم يا زمالك كل الدعم ليكم يا رجاله ⚪🔴 الدوري يا زمالك الدوري يا زمالك صداره بس\n","arabert_prep  ال+ حمدلله يارب فوز مهم يا زمالك . كل ال+ دعم لي +كم يا رجال +ة ⚪ ? ? < LF > ال+ دوري يا زمالك . ال+ دوري يا زمالك < LF > # صدار +ة _ بس\n","------\n","Original:  فدوه يا بخت فدوه يا زمن واحد منكم يجيبه\n","normal_pre:  فدوه يا بخت فدوه يا زمن واحد منكم يجيبه\n","arabert_prep  ف+ دو +ه يا بخت ف+ دو +ه يا زمن واحد من +كم يجيب +ه\n","------\n","Original:  RT @USER: يا رب يا واحد يا أحد بحق يوم الاحد ان تهلك بني سعود المجرمين. لاجل اطفال اليمن شاركوا.\n","normal_pre:  يا رب يا واحد يا احد بحق يوم الاحد ان تهلك بني سعود المجرمين لاجل اطفال اليمن شاركوا\n","arabert_prep  RT [مستخدم] : يا رب يا واحد يا أحد ب+ حق يوم ال+ احد +ان تهلك بني سعود ال+ مجرم +ين . ل+ أجل أطفال ال+ يمن شارك +وا .\n","------\n","Original:  RT @USER: #هوا_الحرية يا وجع قلبي عليكي يا امي...<LF>الله لا يحرق قلبك ويكسر بخاطرك للمرة الف نقف إجلال لعظمة وقدرة لين قلب الأم ال…\n","normal_pre:  هوا الحريه يا وجع قلبي عليكي يا امي الله لا يحرق قلبك ويكسر بخاطرك للمره الف نقف اجلال لعظمه وقدره لين قلب الام ال…\n","arabert_prep  RT [مستخدم] : # هو +ا _ ال+ حري +ة يا وجع قلب +ي عليكي يا أم +ي . < LF > الله لا يحرق قلب ك+ و+ يكسر ب+ خاطر ك+ ل+ ال+ مر +ة ألف نقف إجلال ل+ عظم +ة و+ قدر +ة لين قلب ال+ أم ال+ \\ .\n","------\n","Original:  يا بكون بحياتك الأهم يا إما ما بدي أكون 🎼\n","normal_pre:  يا بكون بحياتك الاهم يا اما ما بدي اكون 🎼\n","arabert_prep  يا ب+ كون ب+ حيا +ت ك+ ال+ أهم يا إما ما بدي أكون ? ?\n","------\n","Original:  @USER اخخ يا قلببي يا هالحلقه 😩😭♥️ متعه على بكاء على حماس كل المشاعر داخله ببعض\n","normal_pre:  اخخ يا قلببي يا هالحلقه 😩😭♥️ متعه علي بكاء علي حماس كل المشاعر داخله ببعض\n","arabert_prep  [مستخدم] اخخ يا قلببي يا هالحلقه ? ? ? ? ♥ ️ متع +ه على بكاء على حماس كل ال+ مشاعر داخل +ه ب+ بعض\n","------\n","Original:  والله الزول السوداني أثبت أنه سابق بالتحضّر عن كل العرب:<LF>٤٠٪ التمثيل النسائي في المجلس التشريعي السوداني ما بعد الثورة. <LF>الكلام إلك يا جارة لتسمعي يا كنّة!<LF>#السودان #سوريا #الجزائر\n","normal_pre:  والله الزول السوداني اثبت انه سابق بالتحضر عن كل العرب التمثيل النسائي في المجلس التشريعي السوداني ما بعد الثوره الكلام الك يا جاره لتسمعي يا كنه ! السودان سوريا الجزائر\n","arabert_prep  و+ الله ال+ زول ال+ سوداني أثبت أن +ه سابق ب+ ال+ تحضر عن كل ال+ عرب : < LF > 40 ٪ ال+ تمثيل ال+ نسائي في ال+ مجلس ال+ تشريعي ال+ سوداني ما بعد ال+ ثور +ة . < LF > ال+ كلام إلك يا جار +ة ل+ تسمع +ي يا +كن +ة ! < LF > # ال+ سودان # سوريا # ال+ جزائر\n","------\n","Original:  RT @USER: جالس أسمع أحمد قاسم يغني: \"أحبك من كل قلبي يا بلادي يا يمن\". حتى أنا والله أحب اليمن من كل قلبي أحب بلادي من طرفها لطرفها \"ب…\n","normal_pre:  جالس اسمع احمد قاسم يغني \"احبك من كل قلبي يا بلادي يا يمن\" حتي انا والله احب اليمن من كل قلبي احب بلادي من طرفها لطرفها \"ب…\n","arabert_prep  RT [مستخدم] : جالس أسمع أحمد قاسم يغني : \" أحب ك+ من كل قلب +ي يا بلاد +ي يا يمن \" . حتى أنا و+ الله أحب ال+ يمن من كل قلب +ي أحب بلاد +ي من طرف +ها ل+ طرف +ها \" ب+ \\ .\n","------\n","Original:  في قلبي يا مغلاك<LF>وبعيني يا محلاك ..\n","normal_pre:  في قلبي يا مغلاك وبعيني يا محلاك\n","arabert_prep  في قلب +ي يا مغلا ك+ < LF > و+ ب+ عيني يا محلا ك+ .\n","------\n","Original:  يا التاج ع الراس يا السادة<LF>يا مالك الروح وراعيها❤️\n","normal_pre:  يا التاج ع الراس يا الساده يا مالك الروح وراعيها❤️\n","arabert_prep  يا ال+ تاج ع ال+ رأس يا ال+ ساد +ة < LF > يا مالك ال+ روح و+ راعي +ها ❤ ️\n","------\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"4YS7XI2bZTyz","executionInfo":{"status":"ok","timestamp":1621932147388,"user_tz":-180,"elapsed":736,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["class BERTDataset(Dataset):\n","    def __init__(self, text, target, model_name, max_len, label_map):\n","      super(BERTDataset).__init__()\n","      self.text = text\n","      self.target = target\n","      self.tokenizer_name = model_name\n","      self.tokenizer = AutoTokenizer.from_pretrained(model_name)\n","      self.max_len = max_len\n","      self.label_map = label_map\n","      \n","\n","    def __len__(self):\n","      return len(self.text)\n","\n","    def __getitem__(self,item):\n","      text = str(self.text[item])\n","      text = \" \".join(text.split())\n","\n","\n","        \n","      input_ids = self.tokenizer.encode(\n","          text,\n","          add_special_tokens=True,\n","          max_length=self.max_len,\n","          truncation='longest_first'\n","      )     \n","    \n","      attention_mask = [1] * len(input_ids)\n","\n","      # Zero-pad up to the sequence length.\n","      padding_length = self.max_len - len(input_ids)\n","      input_ids = input_ids + ([self.tokenizer.pad_token_id] * padding_length)\n","      attention_mask = attention_mask + ([0] * padding_length)    \n","      \n","      return InputFeatures(input_ids=input_ids, attention_mask=attention_mask, label=self.label_map[self.target[item]])"],"execution_count":101,"outputs":[]},{"cell_type":"code","metadata":{"id":"mciZOFz-amkV","colab":{"base_uri":"https://localhost:8080/","height":132,"referenced_widgets":["ddb80760c3d84f05870ff23ec9250414","1d6e1dd89449418ca394402889b733e0","28219a6ccbd04595ba174f2b6b063948","54f96e5a8734423094beb8655482e705","3b6d9d96bdab4eed8441c36b41c23402","cf28eb1b8f8c40a69b9334a37aa57c55","340d51ebaa2c4e34afc4a0f9e32d8d45","41abeeb452804367a26c7fb427c97529","5cca4c780aef45b9983beb5b176f5946","ead495a460af4ea69efc05f41435b2b9","dc9e2b84450742fe9dcf3a5204223b01","6c8d02cc0b2948a280b3bdcfbd137f58","474c7f0bbd604a89bda295f06c22e341","29b043f0d4a9434f8ff26a33e87b40ca","466cecf8b56a437faead1f35d0b2f8b6","53f5a06882b348d5a027599ef9dcb5ba"]},"executionInfo":{"status":"ok","timestamp":1621932193778,"user_tz":-180,"elapsed":5488,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"a889bab3-28b9-4546-d012-4870038f4dc4"},"source":["label_map = { v:index for index, v in enumerate(selected_dataset.label_list) }\n","print(label_map)\n","# label_map_test = { v:index for index, v in enumerate(df_test_labels.HS_Labels) }\n","# print(label_map_test)\n","# label_map_valid = { v:index for index, v in enumerate(df_valid.HS_Labels) }\n","# print(label_map_valid)\n","# train_dataset = BERTDataset(selected_dataset.train[DATA_COLUMN].to_list(),selected_dataset.train[LABEL_COLUMN].to_list(),model_name,max_len,label_map)\n","# test_dataset = BERTDataset(selected_dataset.test[DATA_COLUMN].to_list(),selected_dataset.test[LABEL_COLUMN].to_list(),model_name,max_len,label_map)\n","\n","train_dataset = BERTDataset(arabert_prep_train.to_list(),selected_dataset.train[LABEL_COLUMN].to_list(),model_name,max_len,label_map)\n","valid_dataset = BERTDataset(arabert_prep_valid.to_list(),selected_dataset.valid[LABEL_COLUMN].to_list(),model_name,max_len,label_map)\n","test_dataset = BERTDataset(arabert_prep_test.to_list(),selected_dataset.test[LABEL_COLUMN].to_list(),model_name,max_len,label_map)"],"execution_count":102,"outputs":[{"output_type":"stream","text":["{'OFF': 0, 'NOT_OFF': 1}\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ddb80760c3d84f05870ff23ec9250414","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=576.0, style=ProgressStyle(description_…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"5cca4c780aef45b9983beb5b176f5946","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=717711.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"lt7l0IxjbmNu","executionInfo":{"status":"ok","timestamp":1621932193781,"user_tz":-180,"elapsed":7,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["def model_init():\n","    return AutoModelForSequenceClassification.from_pretrained(model_name, return_dict=True, num_labels=len(label_map))"],"execution_count":103,"outputs":[]},{"cell_type":"code","metadata":{"id":"UYU6G4vWc5nz","executionInfo":{"status":"ok","timestamp":1621932193782,"user_tz":-180,"elapsed":6,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["def compute_metrics(p): #p should be of type EvalPrediction\n","  preds = np.argmax(p.predictions, axis=1)\n","  assert len(preds) == len(p.label_ids)\n","  print(classification_report(p.label_ids,preds))\n","  print(confusion_matrix(p.label_ids,preds))\n","\n","  macro_f1_pos_neg = f1_score(p.label_ids,preds,average='macro',labels=[0,1])\n","  macro_f1 = f1_score(p.label_ids,preds,average='macro')\n","  macro_precision = precision_score(p.label_ids,preds,average='macro')\n","  macro_recall = recall_score(p.label_ids,preds,average='macro')\n","  acc = accuracy_score(p.label_ids,preds)\n","  return {\n","      'macro_f1' : macro_f1,\n","      'macro_f1_pos_neg' : macro_f1_pos_neg,  \n","      'macro_precision': macro_precision,\n","      'macro_recall': macro_recall,\n","      'accuracy': acc\n","  }"],"execution_count":104,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"GnqiZOT37ByE"},"source":["# HyperParameter Search"]},{"cell_type":"markdown","metadata":{"id":"bJif-78C6Kmn"},"source":["you can change the batch size and gradient accumulation from here\n","\n"]},{"cell_type":"code","metadata":{"id":"L3Z_kPB-dE_w","executionInfo":{"status":"ok","timestamp":1621932196964,"user_tz":-180,"elapsed":461,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["training_args = TrainingArguments(\"./train\")\n","training_args.evaluate_during_training = True\n","training_args.adam_epsilon = 1e-8\n","training_args.lr_scheduler_type = 'cosine'\n","training_args.fp16 = True\n","training_args.per_device_train_batch_size = 16\n","training_args.per_device_eval_batch_size = 16\n","training_args.gradient_accumulation_steps = 2\n","training_args.num_train_epochs= 8\n","training_args.evaluation_strategy = EvaluationStrategy.EPOCH\n","# training_args.logging_steps = 200\n","training_args.save_steps = 100000\n","# training_args.save_steps = \n","#training_args.eval_steps = \n","training_args.disable_tqdm = True\n","# print(\"Logging Step:\", training_args.logging_steps)\n","# print(\"Eval Step:\",training_args.eval_steps)"],"execution_count":105,"outputs":[]},{"cell_type":"code","metadata":{"id":"KeqRACPYheeb","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1621932202855,"user_tz":-180,"elapsed":401,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"ee735970-7122-442a-f5d3-028b3919243a"},"source":["steps_per_epoch = (len(selected_dataset.train)// (training_args.per_device_train_batch_size * training_args.gradient_accumulation_steps))\n","total_steps = steps_per_epoch * training_args.num_train_epochs\n","print(steps_per_epoch)\n","print(total_steps)"],"execution_count":106,"outputs":[{"output_type":"stream","text":["218\n","1744\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"o8HOnY6odcwG","colab":{"base_uri":"https://localhost:8080/","height":171,"referenced_widgets":["ad148f44e3f04b63809850bcdb418f6c","5d5d17b7f99547a69ddc82842ab43bc2","04e0e6c67b4e45759f50a7265783a5c6","68de035902234e77aa9e1196a8231339","fc2e93c9cd544ed0aaf1d76ab5e4005c","5b9d84c8f561444db8ad803a02f7e144","b6b4ddaa50d34a958e3f25c2e4661796","7f67cfd59dd640019845360903a0dc3f"]},"executionInfo":{"status":"ok","timestamp":1621932240336,"user_tz":-180,"elapsed":33240,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"7945e8df-ebf2-4004-98af-c3399031499e"},"source":["trainer = Trainer(\n","    args=training_args,\n","    train_dataset=train_dataset, \n","    eval_dataset=valid_dataset, \n","    model_init=model_init,\n","    compute_metrics=compute_metrics,\n",")"],"execution_count":107,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ad148f44e3f04b63809850bcdb418f6c","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=543452854.0, style=ProgressStyle(descri…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"stream","text":["Some weights of the model checkpoint at qarib/bert-base-qarib were not used when initializing BertForSequenceClassification: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight', 'cls.predictions.decoder.bias', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias']\n","- This IS expected if you are initializing BertForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing BertForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of BertForSequenceClassification were not initialized from the model checkpoint at qarib/bert-base-qarib and are newly initialized: ['classifier.weight', 'classifier.bias']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"AFZ94M7Rzkhh","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1621932240338,"user_tz":-180,"elapsed":17,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"8e6ba6b5-f595-4910-f91c-50808d83eff8"},"source":["def my_hp_space(trial):\n","    return {\n","        \"learning_rate\": trial.suggest_float(\"learning_rate\", 2e-5, 7e-5, step=1e-5),\n","        \"seed\": trial.suggest_categorical(\"seed\", [0, 1, 42, 666, 123, 12345]),\n","        \"warmup_steps\": trial.suggest_int(\"warmup_steps\",0,total_steps*0.1,step=total_steps*0.1*0.5)\n","    }\n","\n","search_space = {\n","    \"learning_rate\":  list(np.arange(2e-5, 7e-5, 1e-5)),\n","    \"seed\":  [0, 1, 42, 666, 123, 12345],\n","    \"warmup_steps\": list(range(0, int((total_steps)*0.1)+1, int(total_steps*0.1*0.5)))\n","}\n","search_space"],"execution_count":108,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'learning_rate': [2e-05,\n","  3.0000000000000004e-05,\n","  4.000000000000001e-05,\n","  5.000000000000001e-05,\n","  6.000000000000001e-05],\n"," 'seed': [0, 1, 42, 666, 123, 12345],\n"," 'warmup_steps': [0, 87, 174]}"]},"metadata":{"tags":[]},"execution_count":108}]},{"cell_type":"code","metadata":{"id":"PgfU2UVzfS_A","executionInfo":{"status":"ok","timestamp":1621932240339,"user_tz":-180,"elapsed":16,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["def my_objective(metrics):\n","    return metrics['eval_macro_f1']"],"execution_count":109,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"nc4gOvtE66Mj"},"source":["choose a study name to save it on disk"]},{"cell_type":"code","metadata":{"id":"NSGLnBKv64sZ","executionInfo":{"status":"aborted","timestamp":1621929269357,"user_tz":-180,"elapsed":55,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}}},"source":["# name = \"qarib-semeval\""],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"7l821sW7fdaY"},"source":["# best_run = trainer.hyperparameter_search(direction=\"maximize\",\n","#                                          hp_space=my_hp_space,\n","#                                          compute_objective=my_objective,\n","#                                          n_trials=None,\n","#                                          pruner=optuna.pruners.NopPruner(),\n","#                                          sampler=optuna.samplers.GridSampler(search_space),\n","#                                          study_name=name,\n","#                                          storage=\"sqlite:////content/drive/MyDrive/{}.db\".format(name),\n","#                                          load_if_exists=False # you can change this to true, for continuing the search\n","#                                          )"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"OVwfM9ZJf12t"},"source":["# best_run"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"vTmvFEs41WkV"},"source":["#Regular Training"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"kTLYpWADhZPq","executionInfo":{"status":"ok","timestamp":1621932240339,"user_tz":-180,"elapsed":15,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"9f1822ae-baa0-47bc-8b16-367aaf9ffc5c"},"source":["training_args = TrainingArguments(\"./train\")\n","training_args.evaluate_during_training = True\n","training_args.adam_epsilon = 1e-8\n","training_args.learning_rate = 5e-5\n","training_args.fp16 = True\n","training_args.per_device_train_batch_size = 16\n","training_args.per_device_eval_batch_size = 16\n","training_args.gradient_accumulation_steps = 2\n","training_args.num_train_epochs= 8\n","\n","\n","steps_per_epoch = (len(selected_dataset.train)// (training_args.per_device_train_batch_size * training_args.gradient_accumulation_steps))\n","total_steps = steps_per_epoch * training_args.num_train_epochs\n","print(steps_per_epoch)\n","print(total_steps)\n","#Warmup_ratio\n","warmup_ratio = 0.1\n","training_args.warmup_steps = total_steps*warmup_ratio # or you can set the warmup steps directly \n","\n","training_args.evaluation_strategy = EvaluationStrategy.EPOCH\n","# training_args.logging_steps = 200\n","training_args.save_steps = 100000 #don't want to save any model, there is probably a better way to do this :)\n","training_args.seed = 42\n","training_args.disable_tqdm = False\n","training_args.lr_scheduler_type = 'cosine'"],"execution_count":110,"outputs":[{"output_type":"stream","text":["218\n","1744\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"V_oGjIC-7Vow"},"source":["This paert allows you to do a regular training with no hyper parameter optimization"]},{"cell_type":"code","metadata":{"id":"Ro5BW5ak4uc1","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1621932258794,"user_tz":-180,"elapsed":18467,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"1d5631a1-1758-428e-c90b-5dec34635e70"},"source":["trainer = Trainer(\n","    model = model_init(),\n","    args = training_args,\n","    train_dataset = train_dataset,\n","    eval_dataset=valid_dataset,\n","    compute_metrics=compute_metrics,\n",")"],"execution_count":111,"outputs":[{"output_type":"stream","text":["Some weights of the model checkpoint at qarib/bert-base-qarib were not used when initializing BertForSequenceClassification: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight', 'cls.predictions.decoder.bias', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias']\n","- This IS expected if you are initializing BertForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing BertForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of BertForSequenceClassification were not initialized from the model checkpoint at qarib/bert-base-qarib and are newly initialized: ['classifier.weight', 'classifier.bias']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"yx336O3J2SdQ","colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1621933315156,"user_tz":-180,"elapsed":1052101,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"77351c8b-574d-4d35-cb83-9ff98323aba0"},"source":["trainer.train()"],"execution_count":112,"outputs":[{"output_type":"display_data","data":{"text/html":["\n","    <div>\n","        <style>\n","            /* Turns off some styling */\n","            progress {\n","                /* gets rid of default border in Firefox and Opera. */\n","                border: none;\n","                /* Needs to be in here for Safari polyfill so background images work as expected. */\n","                background-size: auto;\n","            }\n","        </style>\n","      \n","      <progress value='1744' max='1744' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [1744/1744 17:31, Epoch 7/8]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: left;\">\n","      <th>Epoch</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>Macro F1</th>\n","      <th>Macro F1 Pos Neg</th>\n","      <th>Macro Precision</th>\n","      <th>Macro Recall</th>\n","      <th>Accuracy</th>\n","      <th>Runtime</th>\n","      <th>Samples Per Second</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>0</td>\n","      <td>No log</td>\n","      <td>0.162585</td>\n","      <td>0.909849</td>\n","      <td>0.909849</td>\n","      <td>0.927244</td>\n","      <td>0.894675</td>\n","      <td>0.949000</td>\n","      <td>6.215600</td>\n","      <td>160.887000</td>\n","    </tr>\n","    <tr>\n","      <td>1</td>\n","      <td>No log</td>\n","      <td>0.199422</td>\n","      <td>0.908291</td>\n","      <td>0.908291</td>\n","      <td>0.894261</td>\n","      <td>0.924394</td>\n","      <td>0.944000</td>\n","      <td>6.876900</td>\n","      <td>145.415000</td>\n","    </tr>\n","    <tr>\n","      <td>2</td>\n","      <td>0.211100</td>\n","      <td>0.314470</td>\n","      <td>0.893652</td>\n","      <td>0.893652</td>\n","      <td>0.903961</td>\n","      <td>0.884216</td>\n","      <td>0.939000</td>\n","      <td>6.844800</td>\n","      <td>146.096000</td>\n","    </tr>\n","    <tr>\n","      <td>3</td>\n","      <td>0.211100</td>\n","      <td>0.317895</td>\n","      <td>0.898274</td>\n","      <td>0.898274</td>\n","      <td>0.880222</td>\n","      <td>0.920131</td>\n","      <td>0.937000</td>\n","      <td>6.849200</td>\n","      <td>146.002000</td>\n","    </tr>\n","    <tr>\n","      <td>4</td>\n","      <td>0.036200</td>\n","      <td>0.378496</td>\n","      <td>0.901696</td>\n","      <td>0.901696</td>\n","      <td>0.915406</td>\n","      <td>0.889445</td>\n","      <td>0.944000</td>\n","      <td>6.854500</td>\n","      <td>145.889000</td>\n","    </tr>\n","    <tr>\n","      <td>5</td>\n","      <td>0.036200</td>\n","      <td>0.400179</td>\n","      <td>0.898465</td>\n","      <td>0.898465</td>\n","      <td>0.884779</td>\n","      <td>0.914187</td>\n","      <td>0.938000</td>\n","      <td>6.849000</td>\n","      <td>146.007000</td>\n","    </tr>\n","    <tr>\n","      <td>6</td>\n","      <td>0.004800</td>\n","      <td>0.393917</td>\n","      <td>0.897482</td>\n","      <td>0.897482</td>\n","      <td>0.899246</td>\n","      <td>0.895746</td>\n","      <td>0.940000</td>\n","      <td>6.865000</td>\n","      <td>145.666000</td>\n","    </tr>\n","    <tr>\n","      <td>7</td>\n","      <td>0.004800</td>\n","      <td>0.398144</td>\n","      <td>0.894528</td>\n","      <td>0.894528</td>\n","      <td>0.894528</td>\n","      <td>0.894528</td>\n","      <td>0.938000</td>\n","      <td>6.842900</td>\n","      <td>146.138000</td>\n","    </tr>\n","  </tbody>\n","</table><p>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","           0       0.90      0.81      0.85       179\n","           1       0.96      0.98      0.97       821\n","\n","    accuracy                           0.95      1000\n","   macro avg       0.93      0.89      0.91      1000\n","weighted avg       0.95      0.95      0.95      1000\n","\n","[[145  34]\n"," [ 17 804]]\n","              precision    recall  f1-score   support\n","\n","           0       0.81      0.89      0.85       179\n","           1       0.98      0.95      0.97       821\n","\n","    accuracy                           0.94      1000\n","   macro avg       0.89      0.92      0.91      1000\n","weighted avg       0.95      0.94      0.95      1000\n","\n","[[160  19]\n"," [ 37 784]]\n","              precision    recall  f1-score   support\n","\n","           0       0.85      0.80      0.82       179\n","           1       0.96      0.97      0.96       821\n","\n","    accuracy                           0.94      1000\n","   macro avg       0.90      0.88      0.89      1000\n","weighted avg       0.94      0.94      0.94      1000\n","\n","[[143  36]\n"," [ 25 796]]\n","              precision    recall  f1-score   support\n","\n","           0       0.78      0.89      0.84       179\n","           1       0.98      0.95      0.96       821\n","\n","    accuracy                           0.94      1000\n","   macro avg       0.88      0.92      0.90      1000\n","weighted avg       0.94      0.94      0.94      1000\n","\n","[[160  19]\n"," [ 44 777]]\n","              precision    recall  f1-score   support\n","\n","           0       0.87      0.80      0.84       179\n","           1       0.96      0.97      0.97       821\n","\n","    accuracy                           0.94      1000\n","   macro avg       0.92      0.89      0.90      1000\n","weighted avg       0.94      0.94      0.94      1000\n","\n","[[144  35]\n"," [ 21 800]]\n","              precision    recall  f1-score   support\n","\n","           0       0.80      0.88      0.84       179\n","           1       0.97      0.95      0.96       821\n","\n","    accuracy                           0.94      1000\n","   macro avg       0.88      0.91      0.90      1000\n","weighted avg       0.94      0.94      0.94      1000\n","\n","[[157  22]\n"," [ 40 781]]\n","              precision    recall  f1-score   support\n","\n","           0       0.84      0.83      0.83       179\n","           1       0.96      0.96      0.96       821\n","\n","    accuracy                           0.94      1000\n","   macro avg       0.90      0.90      0.90      1000\n","weighted avg       0.94      0.94      0.94      1000\n","\n","[[148  31]\n"," [ 29 792]]\n","              precision    recall  f1-score   support\n","\n","           0       0.83      0.83      0.83       179\n","           1       0.96      0.96      0.96       821\n","\n","    accuracy                           0.94      1000\n","   macro avg       0.89      0.89      0.89      1000\n","weighted avg       0.94      0.94      0.94      1000\n","\n","[[148  31]\n"," [ 31 790]]\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=1744, training_loss=0.07239586871048999, metrics={'train_runtime': 1052.028, 'train_samples_per_second': 1.658, 'total_flos': 11600681300041728, 'epoch': 8.0})"]},"metadata":{"tags":[]},"execution_count":112}]},{"cell_type":"code","metadata":{"id":"agqaiJStrc_w","colab":{"base_uri":"https://localhost:8080/","height":377},"executionInfo":{"status":"ok","timestamp":1621933329102,"user_tz":-180,"elapsed":13183,"user":{"displayName":"Do salam","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgP0GyFxHH-3NAPSZ_ethp4uMqaN8pUWhOxcO0NDw=s64","userId":"03587359084159229589"}},"outputId":"d19f2649-a8dc-4322-fc16-b744eab70d02"},"source":["trainer.evaluate(test_dataset)"],"execution_count":113,"outputs":[{"output_type":"display_data","data":{"text/html":["\n","    <div>\n","        <style>\n","            /* Turns off some styling */\n","            progress {\n","                /* gets rid of default border in Firefox and Opera. */\n","                border: none;\n","                /* Needs to be in here for Safari polyfill so background images work as expected. */\n","                background-size: auto;\n","            }\n","        </style>\n","      \n","      <progress value='125' max='125' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [125/125 00:13]\n","    </div>\n","    "],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","           0       0.88      0.87      0.87       402\n","           1       0.97      0.97      0.97      1598\n","\n","    accuracy                           0.95      2000\n","   macro avg       0.92      0.92      0.92      2000\n","weighted avg       0.95      0.95      0.95      2000\n","\n","[[ 350   52]\n"," [  49 1549]]\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["{'epoch': 8.0,\n"," 'eval_accuracy': 0.9495,\n"," 'eval_loss': 0.36352843046188354,\n"," 'eval_macro_f1': 0.92116762455808,\n"," 'eval_macro_f1_pos_neg': 0.92116762455808,\n"," 'eval_macro_precision': 0.9223566411343787,\n"," 'eval_macro_recall': 0.9199917185038512,\n"," 'eval_runtime': 13.6511,\n"," 'eval_samples_per_second': 146.509}"]},"metadata":{"tags":[]},"execution_count":113}]},{"cell_type":"code","metadata":{"id":"Seyz8Yaj2ZCK"},"source":["trainer.save_model(\"QARIB MODEL\")"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"xd1iuK-UFjEV"},"source":[""],"execution_count":null,"outputs":[]}]}